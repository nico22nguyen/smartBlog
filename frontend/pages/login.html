<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Blog</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="login.css">
    <script>
        const PORT = 8000

        window.onload = () => {
            document.getElementById('form')
            .addEventListener('submit', login);
        }

        const login = (e) => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            if (!email || !password) {
                console.log('Email and password are required');
            }
            const payload = { email, password }
            console.log(payload)

            return fetch(`http://localhost:${PORT}/api/auth`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload),
            })
                .then(res => {
                    if (res.ok) return
                    else if (res.status === 401) return alert('Incorrect Password')
                    else if (res.status === 404) return alert(`An account is not registered under email: ${email}`)
                    else res.text().then(text => console.error(text))
                })
                .catch(error => console.error(error));
            }
    </script>
</head>
<body>  
<title>Document</title>

<div class="content">
    <h2>Smart Blog Login</h2>
  <form id="form" method="post" action='feed'>
       <div class="inputbox">
          <span>Email</span>
          <input type="text" id="email" required>
       </div>
       <div class="inputbox">                 
        <span>Password</span>                  
        <input type="password" id="password" required>
      </div>
      <div class="inputbox">
         <input type="submit" value="Login">
      </div>
  </form>
  <p>Don't have an account?&nbsp;<a href="/register">Sign up</a></p>
  <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"
      integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk"
      crossorigin="anonymous"/>

        